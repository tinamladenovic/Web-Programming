{"ast":null,"code":"import axios from 'axios';\nimport { ref, onMounted } from 'vue';\nexport default {\n  setup() {\n    const user = ref({\n      id: '',\n      username: '',\n      password: '',\n      firstName: '',\n      lastName: '',\n      gender: '',\n      birthDate: '',\n      role: '',\n      customerType: '',\n      earnedPoints: 0,\n      shoppingCart: ''\n    });\n    const purchases = ref([]);\n    const factories = ref([]);\n    const fetchUserProfile = async () => {\n      try {\n        const response = await axios.get('http://localhost:8080/WebShopAppREST/rest/currentUser', {\n          withCredentials: true\n        });\n        user.value = response.data;\n\n        // Fetch user purchases\n        const purchasesResponse = await axios.get(`http://localhost:8080/WebShopAppREST/rest/users/${user.value.id}/purchases`, {\n          withCredentials: true\n        });\n        purchases.value = purchasesResponse.data;\n\n        // Fetch all factories to map factory IDs to names\n        const factoriesResponse = await axios.get('http://localhost:8080/WebShopAppREST/rest/chocolateFactoryObjects', {\n          withCredentials: true\n        });\n        factories.value = factoriesResponse.data;\n      } catch (error) {\n        console.error('Error fetching user profile or purchases:', error);\n      }\n    };\n    const getFactoryName = chocolate => {\n      const factory = factories.value.find(factory => factory.factoryId === chocolate.factoryId);\n      return factory ? factory.name : 'Unknown Factory';\n    };\n    const updateProfile = async () => {\n      if (!user.value.username || !user.value.firstName || !user.value.lastName) {\n        alert('Username, First Name, and Last Name are required.');\n        return;\n      }\n      try {\n        const response = await axios.put('http://localhost:8080/WebShopAppREST/rest/profile', user.value, {\n          withCredentials: true,\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        alert('Profile updated successfully!');\n        console.log(response.data);\n      } catch (error) {\n        console.error('Error updating profile:', error.response ? error.response.data : error.message);\n        alert('Failed to update profile. Please try again.');\n      }\n    };\n    onMounted(() => {\n      fetchUserProfile();\n    });\n    return {\n      user,\n      purchases,\n      factories,\n      getFactoryName,\n      updateProfile\n    };\n  }\n};","map":{"version":3,"names":["axios","ref","onMounted","setup","user","id","username","password","firstName","lastName","gender","birthDate","role","customerType","earnedPoints","shoppingCart","purchases","factories","fetchUserProfile","response","get","withCredentials","value","data","purchasesResponse","factoriesResponse","error","console","getFactoryName","chocolate","factory","find","factoryId","name","updateProfile","alert","put","headers","log","message"],"sources":["C:\\Users\\PC\\eclipse-workspace\\apache-tomcat-9.0.89\\apache-tomcat-9.0.89\\webapps\\chocolate-factory-2\\Kostur\\Frontend\\front-app\\src\\views\\UserProfile.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-profile\">\r\n    <h2>User Profile</h2>\r\n    <form @submit.prevent=\"updateProfile\">\r\n      <!-- Postojeća polja za ažuriranje profila -->\r\n      <div class=\"form-group\">\r\n        <label for=\"username\">Username:</label>\r\n        <input v-model=\"user.username\" id=\"username\" name=\"username\" class=\"form-control\" autocomplete=\"username\" required />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"firstName\">First Name:</label>\r\n        <input v-model=\"user.firstName\" id=\"firstName\" name=\"firstName\" class=\"form-control\" autocomplete=\"given-name\" required />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"lastName\">Last Name:</label>\r\n        <input v-model=\"user.lastName\" id=\"lastName\" name=\"lastName\" class=\"form-control\" autocomplete=\"family-name\" required />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"password\">Password:</label>\r\n        <input v-model=\"user.password\" id=\"password\" name=\"password\" class=\"form-control\" autocomplete=\"new-password\" required />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"gender\">Gender:</label>\r\n        <select v-model=\"user.gender\" id=\"gender\" name=\"gender\" class=\"form-control\" autocomplete=\"sex\" required>\r\n          <option value=\"MALE\">Male</option>\r\n          <option value=\"FEMALE\">Female</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"birthDate\">Birth Date:</label>\r\n        <input v-model=\"user.birthDate\" id=\"birthDate\" name=\"birthDate\" type=\"date\" class=\"form-control\" autocomplete=\"bday\" required />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"role\">Role:</label>\r\n        <p id=\"role\">{{ user.role }}</p>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"customerType\">Customer Type:</label>\r\n        <p id=\"customerType\">{{ user.customerType }}</p>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"earnedPoints\">Earned Points:</label>\r\n        <p id=\"earnedPoints\">{{ user.earnedPoints }}</p>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"shoppingCart\">Shopping Cart:</label>\r\n        <p id=\"shoppingCart\">{{ user.shoppingCart }}</p>\r\n      </div>\r\n      <button type=\"submit\" class=\"btn\">Update Profile</button>\r\n    </form>\r\n\r\n    <!-- Sekcija za prikaz kupovina -->\r\n    <div class=\"purchases\" v-if=\"purchases.length\">\r\n      <h2>Moje kupovine</h2>\r\n      <ul class=\"purchase-list\">\r\n        <li v-for=\"purchase in purchases\" :key=\"purchase.id\">\r\n          <div class=\"purchase-details\">\r\n            <p><strong>Datum:</strong> {{ purchase.purchaseDateTime }}</p>\r\n            <p><strong>Ukupna cena:</strong> {{ purchase.price }} RSD</p>\r\n            <p><strong>Proizvodi:</strong></p>\r\n            <ul>\r\n              <li v-for=\"item in purchase.chocolates\" :key=\"item.id\">\r\n                {{ item.name }} - {{ item.quantity }} pcs \r\n                <span v-if=\"getFactoryName(item)\"> (Fabrika: {{ getFactoryName(item) }})</span>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { ref, onMounted } from 'vue';\r\n\r\nexport default {\r\n  setup() {\r\n    const user = ref({\r\n      id: '',\r\n      username: '',\r\n      password: '',\r\n      firstName: '',\r\n      lastName: '',\r\n      gender: '',\r\n      birthDate: '',\r\n      role: '',\r\n      customerType: '',\r\n      earnedPoints: 0,\r\n      shoppingCart: ''\r\n    });\r\n\r\n    const purchases = ref([]);\r\n    const factories = ref([]);\r\n\r\n    const fetchUserProfile = async () => {\r\n      try {\r\n        const response = await axios.get('http://localhost:8080/WebShopAppREST/rest/currentUser', {\r\n          withCredentials: true\r\n        });\r\n        user.value = response.data;\r\n\r\n        // Fetch user purchases\r\n        const purchasesResponse = await axios.get(`http://localhost:8080/WebShopAppREST/rest/users/${user.value.id}/purchases`, {\r\n          withCredentials: true\r\n        });\r\n        purchases.value = purchasesResponse.data;\r\n\r\n        // Fetch all factories to map factory IDs to names\r\n        const factoriesResponse = await axios.get('http://localhost:8080/WebShopAppREST/rest/chocolateFactoryObjects', {\r\n          withCredentials: true\r\n        });\r\n        factories.value = factoriesResponse.data;\r\n      } catch (error) {\r\n        console.error('Error fetching user profile or purchases:', error);\r\n      }\r\n    };\r\n\r\n    const getFactoryName = (chocolate) => {\r\n      const factory = factories.value.find(factory => factory.factoryId === chocolate.factoryId);\r\n      return factory ? factory.name : 'Unknown Factory';\r\n    };\r\n\r\n    const updateProfile = async () => {\r\n      if (!user.value.username || !user.value.firstName || !user.value.lastName) {\r\n        alert('Username, First Name, and Last Name are required.');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await axios.put('http://localhost:8080/WebShopAppREST/rest/profile', user.value, {\r\n          withCredentials: true,\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n        alert('Profile updated successfully!');\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        console.error('Error updating profile:', error.response ? error.response.data : error.message);\r\n        alert('Failed to update profile. Please try again.');\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      fetchUserProfile();\r\n    });\r\n\r\n    return {\r\n      user,\r\n      purchases,\r\n      factories,\r\n      getFactoryName,\r\n      updateProfile\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.user-profile {\r\n  max-width: 600px;\r\n  margin: 40px auto;\r\n  background-color: #f9f9f9;\r\n  padding: 20px;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\nh2 {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n  color: #333;\r\n  font-size: 24px;\r\n  font-weight: 600;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  font-weight: 600;\r\n  margin-bottom: 5px;\r\n  color: #555;\r\n}\r\n\r\ninput[type=\"text\"],\r\ninput[type=\"password\"],\r\ninput[type=\"date\"],\r\nselect {\r\n  width: 100%;\r\n  padding: 10px;\r\n  font-size: 16px;\r\n  border-radius: 5px;\r\n  border: 1px solid #ddd;\r\n  box-sizing: border-box;\r\n  background-color: #fff;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\ninput[type=\"text\"]:focus,\r\ninput[type=\"password\"]:focus,\r\ninput[type=\"date\"]:focus,\r\nselect:focus {\r\n  border-color: #007bff;\r\n  outline: none;\r\n}\r\n\r\np {\r\n  padding: 10px;\r\n  background-color: #f8f8f8;\r\n  border: 1px solid #ddd;\r\n  border-radius: 5px;\r\n  color: #333;\r\n}\r\n\r\nbutton.btn {\r\n  display: block;\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #007bff;\r\n  color: white;\r\n  font-size: 16px;\r\n  border: none;\r\n  border-radius: 5px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\nbutton.btn:hover {\r\n  background-color: #0056b3;\r\n}\r\n\r\n.purchases {\r\n  margin-top: 40px;\r\n}\r\n\r\n.purchase-list {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\n\r\n.purchase-list li {\r\n  margin-bottom: 20px;\r\n  padding: 15px;\r\n  background-color: #f1f1f1;\r\n  border-radius: 5px;\r\n}\r\n\r\n.purchase-details p {\r\n  margin: 5px 0;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}